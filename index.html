<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VergabeAssist ‚Äì Ihre KI-Unterst√ºtzung f√ºr die √∂ffentliche Beschaffung</title>
  <link rel="stylesheet" href="css/style.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
<header>
  <div id="burgerMenu" class="burger-menu" onclick="toggleSidebarMenu()">
    <span></span><span></span><span></span>
  </div>
  <!-- Firmenlogo GovDisrupt AI, zentriert im Header -->
  <div class="header-center">
    <img src="img/logo_govdisrupt_ai.png" alt="GovDisrupt AI Logo" class="header-firm-logo">
  </div>
  <button id="loginTopBtn" class="login-top-btn" onclick="scrollToLogin();">Login</button>
  <div id="accountIcon" style="display:none;position:absolute;right:2rem;top:1.2rem;cursor:pointer;">
    <span title="Account verwalten" style="font-size:2.1rem;">üë§</span>
  </div>
</header>

  <!-- Gro√ües VergabeAssist-Logo oben -->
  <div class="top-firm-logo" style="text-align:center;margin:2em 0 2.1em 0;">
    <img src="img/logo_clean_1.png" alt="VergabeAssist Logo" style="max-width: 370px; width: 100%; height: 100%;">
  </div>

  <main>
    <!-- HERO-BEREICH MIT VIDEO UND CHAT, weniger H√∂he -->
    <section class="hero-video-bg" style="height: 700px; min-height: 430px;">
      <video autoplay loop muted playsinline class="hero-video" style="height: 700px; min-height: 430px;">
        <source src="videos/Startseitenvideo.mp4" type="video/mp4">
        Ihr Browser unterst√ºtzt kein HTML5-Video.
      </video>
      <div class="hero-overlay hero-overlay-column">
        <div class="hero-textblock">
          <div class="hero-headline">So effizient wie ein ganzes Team</div>
          <div class="hero-subline">KI-gest√ºtzt: Produktneutrale Leistungsbeschreibungen und Leistungsverzeichnisse erstellen</div>
        </div>
        <div class="hero-chatbox" id="chat">
          <h2 style="color:#0077B6;">üí¨ Testen Sie den KI-Vergabe-Chat</h2>
          <p style="color:#444;margin-bottom:18px;">Stellen Sie bis zu <strong>5 Fragen t√§glich</strong> ‚Äì kostenlos und ohne Registrierung.</p>
          <div id="guestChatContainer">
            <div id="chatMessages" class="chat-messages"></div>
            <div style="display:flex;gap:0.5rem;margin-top:1rem;">
              <input id="chatInput" type="text" placeholder="Frage eingeben ‚Ä¶" onkeypress="handleChatEnter(event)" style="flex:1;padding:0.5rem;border:1px solid #ccc;border-radius:6px;">
              <button onclick="sendChatMessage()">Senden</button>
            </div>
            <p id="guestChatCounter" style="margin-top:0.5rem;font-size:0.9rem;color:#666;"></p>
          </div>
        </div>
      </div>
    </section>

    <!-- REGISTRIERUNGSBEREICH wie vorher, modern -->
    <div class="hero-registerbox">
      <form class="register-form" onsubmit="event.preventDefault(); gotoRegistration();">
        <input id="heroRegEmail" type="email" placeholder="Ihre dienstliche E-Mail-Adresse" required>
        <button type="submit">Jetzt bei VergabeAssistent registrieren</button>
      </form>
      <ul class="register-features">
        <li>Beschaffungsvorhaben anlegen</li>
        <li>Markterkundungen durchf√ºhren</li>
        <li>Leistungsverzeichnisse generieren</li>
        <li>Vergaberechtliche Fragen stellen</li>
        <li>Ergebnisse exportieren</li>
      </ul>
    </div>

    <!-- WEI√üRAUM/FARBFL√ÑCHE ZWISCHEN VIDEO UND BILD -->
    <div class="section-gap-alt"></div>

    <div id="homepage">
      <!-- VORTEILE-BEREICH AUF BILD-BANNER MIT KACHELN -->
      <section class="vorteile-bildsektion">
        <div class="vorteile-img-wrapper">
          <img src="img/Startseitenfoto.jpg" alt="√ñffentliche Vergabe" class="vorteile-bg-img">
          <div class="vorteile-kacheln-container">
            <div class="vorteil-kachel">
              <span class="vorteil-icon">‚ö°Ô∏è</span>
              <h3>Enorme Zeitersparnis</h3>
              <p>Leistungsverzeichnisse sekundenschnell generieren ‚Äì Routine wird automatisiert, Sie konzentrieren sich aufs Wesentliche.</p>
            </div>
            <div class="vorteil-kachel">
              <span class="vorteil-icon">üß†</span>
              <h3>KI-gest√ºtzte Expertise</h3>
              <p>Immer rechtssichere, aktuelle Antworten auf vergaberechtliche Fragen. Praxisnah, verst√§ndlich, individuell.</p>
            </div>
            <div class="vorteil-kachel">
              <span class="vorteil-icon">üîí</span>
              <h3>DSGVO-konform &amp; sicher</h3>
              <p>Hosting &amp; Datenspeicherung ausschlie√ülich in Europa, gepr√ºft f√ºr den Einsatz in der Verwaltung.</p>
            </div>
          </div>
        </div>
      </section>
    </div>

    <div id="authContainer" style="display:none;padding:2.7rem 0;max-width:560px;margin:auto;">
      <div class="auth-tabs" style="display:flex;gap:1.3rem;margin-bottom:2.2rem;justify-content:center;">
        <button class="auth-tab active" onclick="switchTab('login')">Login</button>
        <button class="auth-tab" onclick="switchTab('register')">Registrieren</button>
      </div>
    <div id="setPasswordContainer" style="display:none;max-width:560px;margin:2.5em auto 1.7em auto;">
      <form id="setPasswordForm" class="auth-form-modern" onsubmit="event.preventDefault(); setNewPassword();">
        <div class="form-group">
          <label for="newPassword">Neues Passwort</label>
          <input id="newPassword" type="password" placeholder="Neues Passwort" required minlength="8">
        </div>
        <button type="submit">Passwort setzen &amp; einloggen</button>
      </form>
    </div>
      <form id="loginForm" class="auth-form-modern">
        <div class="form-group">
          <label for="loginEmail">E-Mail</label>
          <input id="loginEmail" type="email" placeholder="E-Mail">
          <div class="form-error" id="login-error-email"></div>
        </div>
        <div class="form-group">
          <label for="loginPassword">Passwort</label>
          <input id="loginPassword" type="password" placeholder="Passwort">
          <div class="form-error" id="login-error-password"></div>
        </div>
        <button type="button" onclick="login()">Anmelden</button>
        <div style="margin-top:0.8em;font-size:0.97em;text-align:right;">
          <a href="#" onclick="showForgotPassword();return false;" style="color:#0077b6;">Passwort vergessen?</a>
        </div>
        <div class="form-error" id="login-global-error" style="text-align:center;margin-top:0.7em;"></div>
      </form>
      <form id="registerForm" class="auth-form-modern" style="display:none;">
        <div class="form-group">
          <label for="regAnrede">Anrede</label>
          <input id="regAnrede" placeholder="Anrede">
          <div class="form-error" id="error-anrede"></div>
        </div>
        <div class="form-group">
          <label for="regVorname">Vorname</label>
          <input id="regVorname" placeholder="Vorname">
          <div class="form-error" id="error-vorname"></div>
        </div>
        <div class="form-group">
          <label for="regNachname">Nachname</label>
          <input id="regNachname" placeholder="Nachname">
          <div class="form-error" id="error-nachname"></div>
        </div>
        <div class="form-group">
          <label for="regOrganisation">Organisation</label>
          <input id="regOrganisation" placeholder="Organisation">
          <div class="form-error" id="error-organisation"></div>
        </div>
        <div class="form-group">
          <label for="regBundesland">Bundesland</label>
          <input id="regBundesland" placeholder="Bundesland">
          <div class="form-error" id="error-bundesland"></div>
        </div>
        <div class="form-group">
          <label for="regEmail">E-Mail</label>
          <input id="regEmail" type="email" placeholder="E-Mail">
          <div class="form-error" id="error-email"></div>
        </div>
        <div class="form-group">
          <label for="regPassword">Passwort</label>
          <input id="regPassword" type="password" placeholder="Passwort" autocomplete="new-password">
          <div class="form-error" id="error-password"></div>
          <div class="pw-hint">Mindestens 10 Zeichen, je 1 Gro√ü-, Kleinbuchstabe, Zahl &amp; Sonderzeichen.</div>
        </div>
        <button type="button" onclick="register()">Registrieren</button>
      </form>
    </div>

    <!-- DASHBOARD -->
    <div id="dashboard" style="display:none;max-width:1000px;margin:3.5rem auto 2rem auto;">
      <div class="dashboard-header" style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1.7rem;">
        <h2>Meine Beschaffungsvorhaben</h2>
        <button id="addProjectBtn" onclick="neueBeschaffung()" style="padding:0.7em 1.6em;font-size:1.08em;border-radius:9px;border:none;background:#0077b6;color:#fff;font-weight:600;box-shadow:0 2px 8px #0077b642;cursor:pointer;">+ Beschaffungsvorhaben anlegen</button>
      </div>
      <div style="overflow-x:auto;">
        <table class="dashboard-table" style="width:100%;border-collapse:collapse;background:#fff;box-shadow:0 3px 32px #0077b610;border-radius:15px;overflow:hidden;">
          <thead>
            <tr style="background:#f7fafc;color:#222b38;font-size:1.07em;">
              <th style="padding:1em 0.6em;text-align:left;">Name</th>
              <th style="padding:1em 0.6em;text-align:left;">Art der Leistung</th>
              <th style="padding:1em 0.6em;text-align:left;">Status</th>
              <th style="padding:1em 0.6em;text-align:left;">Erstellt am</th>
              <th style="padding:1em 0.6em;text-align:left;">Zuletzt aktualisiert</th>
            </tr>
          </thead>
          <tbody id="dashboardTableBody">
            <tr>
              <td colspan="5" style="padding:2.3em 0;text-align:center;color:#777;font-size:1.1em;">Noch keine Beschaffungsvorhaben angelegt.</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </main>

  <footer id="kontakt" style="display:flex;align-items:center;gap:1.4em;">
    <img src="img/logo_govdisrupt_ai.png" alt="Firmenlogo" style="height:36px;margin-right:1.4em;">
    <span style="flex:1;">&copy; 2025 VergabeAssist | Impressum | Datenschutz</span>
  </footer>

  <div id="sidebarMenu" class="sidebar-menu" style="display:none;">
    <button class="sidebar-close-btn" onclick="toggleSidebarMenu()" aria-label="Men√º schlie√üen">&times;</button>
    <a href="#features">Funktionen</a>
    <a href="#chat">KI-Chat</a>
    <a href="#kontakt">Kontakt</a>
  </div>

  <div id="successOverlay" style="display:none;position:fixed;z-index:1200;top:0;left:0;width:100vw;height:100vh;background:rgba(255,255,255,0.96);align-items:center;justify-content:center;text-align:center;">
    <div style="background:#f7fafc;border-radius:18px;box-shadow:0 6px 48px #7db7ef22;padding:2.6em 2.3em;max-width:420px;margin:auto;">
      <svg id="successCheck" style="width:54px;height:54px;margin-bottom:1em;" viewBox="0 0 48 48"><circle cx="24" cy="24" r="22" fill="#d1f8e1"/><path d="M14 25l7 7l13-13" fill="none" stroke="#10b981" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>
      <div id="successMsg" style="font-size:1.25em;color:#217b3a;font-weight:600;margin-bottom:1.1em;"></div>
      <div style="color:#2a3441;opacity:0.7;">Sie werden gleich zur Startseite weitergeleitet‚Ä¶</div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="js/utils.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/dashboard.js"></script>
  <script src="js/chat.js"></script>
  <script>
    function updateAccountIcon() {
      const icon = document.getElementById('accountIcon');
      if (window.currentUser) {
        icon.style.display = 'block';
      } else {
        icon.style.display = 'none';
      }
    }
    window.updateAccountIcon = updateAccountIcon;
    function updateLoginTopBtn() {
      const btn = document.getElementById('loginTopBtn');
      btn.style.display = window.currentUser ? 'none' : 'inline-block';
    }
    window.updateLoginTopBtn = updateLoginTopBtn;
    window.toggleSidebarMenu = function() {
      const sb = document.getElementById('sidebarMenu');
      sb.style.display = (sb.style.display === 'none' || !sb.style.display) ? 'flex' : 'none';
    };
    document.addEventListener('click', e => {
      if (e.target.closest('.sidebar-menu') || e.target.closest('.burger-menu')) return;
      document.getElementById('sidebarMenu').style.display = 'none';
    });
    // Automatisches Scrollen zum Login-Bereich bei Klick auf Login-Button oben
    window.scrollToLogin = function() {
      showLogin('login');
      setTimeout(() => {
        const el = document.getElementById('authContainer');
        if (el) el.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }, 180);
    }
  </script>
</body>
</html>
